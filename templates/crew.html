<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Crew Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>👥 Crew Management</h2>

        <button class="btn btn-primary mb-3" onclick="addCrew()">➕ Add Crew</button>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Role</th>
                    <th>Shift</th>
                    <th>Route</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="crewTableBody"></tbody>
        </table>
    </div>

    <script>
        function fetchCrew() {
            fetch('/crew')
                .then(res => res.json())
                .then(data => {
                    document.getElementById("crewTableBody").innerHTML = data.map(member => `
                        <tr>
                            <td>${member.id}</td>
                            <td>${member.name}</td>
                            <td>${member.role}</td>
                            <td>${member.shift}</td>
                            <td>${member.assigned_route || "None"}</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="deleteCrew(${member.id})">🗑️</button>
                            </td>
                        </tr>`).join('');
                });
        }

        function addCrew() {
            let name = prompt("Name:");
            let role = prompt("Role:");
            let shift = prompt("Shift:");
            if (name && role && shift) {
                fetch('/crew', {
                    method: 'POST',
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ name, role, shift })
                }).then(() => fetchCrew());
            }
        }

        function deleteCrew(id) {
            fetch('/crew', {
                method: 'DELETE',
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ id })
            }).then(() => fetchCrew());
        }

        window.onload = fetchCrew;
    </script>
</body>
</html>
